(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7dac15f9"],{"84ff":function(e,t,a){"use strict";var i=a("85e0"),s=a.n(i);s.a},"85e0":function(e,t,a){},a716:function(e,t,a){},d270:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"siteArrearage",staticClass:"siteArrearage"},[a("van-tabs",{ref:"tabs",attrs:{color:"#3693ff","title-active-color":"#3693ff",background:"#fff","before-change":e.onBeforeChangeTab,"lazy-render":!1,sticky:""},on:{change:e.onChangeTab},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(t){return a("van-tab",{key:t.type,attrs:{title:t.tabName,name:t.type}},[a("detail-panel",{ref:"detailPanel"+t.type,refInFor:!0,attrs:{tabActive:e.active},on:{onDownTab:e.onDownTab}})],1)})),1)],1)},s=[],c=(a("4de4"),a("a9e3"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"detailPenal"},[a("div",{staticClass:"form-field"},[a("div",{staticClass:"area-search"},[a("van-search",{attrs:{shape:"round",background:"#fff",placeholder:e.placeholder,readonly:""},on:{focus:e.onFocus},model:{value:e.codes,callback:function(t){e.codes=t},expression:"codes"}}),e.codes?a("van-icon",{staticClass:"close-icon",attrs:{name:"close"},on:{click:e.onAreaClean}}):e._e()],1),a("b-select-date",{staticClass:"area-date",attrs:{stype:"year-month",zoneNo:!0,title:"请选择年月",minDate:e.expensesPolicyMinDate,maxDate:e.expensesPolicyMaxDate},on:{change:e.onChangeTime},model:{value:e.selectData.sumDate,callback:function(t){e.$set(e.selectData,"sumDate",t)},expression:"selectData.sumDate"}})],1),a("b-select-site-multiple",{ref:"selectSite",attrs:{defaultData:e.defaultSite,disableTabs:e.disableTabs},on:{change:e.onChangeSite},model:{value:e.selectCode,callback:function(t){e.selectCode=t},expression:"selectCode"}}),a("div",{staticClass:"content"},[a("hy-table",{staticClass:"base-table",attrs:{"table-data":e.tableData,columns:e.tableHeader,scrollWidth:"100%",border:"",theme:"light","border-y":!0,isShowMore:!0,total:e.total,isFixedHeader:!0},on:{updateData:e.updateData,displayMore:e.displayMore}})],1),a("site-popup",{ref:"sitePopup"})],1)}),r=[],n=(a("4160"),a("a15b"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("1276"),a("c7cd"),a("159b"),a("85f2")),o=a.n(n),d=a("d847"),l=a.n(d),h=a("5e83"),u=a.n(h),b=a("268f"),f=a.n(b),p=a("e265"),C=a.n(p),m=a("a4bb"),g=a.n(m),y=a("795b"),D=a.n(y),v=a("967e"),S=a.n(v),k=a("284c"),N=(a("96cf"),a("2fa7")),P=a("0644"),w=a.n(P),T=a("c1df"),q=a.n(T),$=a("538d"),x=a("0532"),A=a("2f62");function z(e,t){var a=g()(e);if(C.a){var i=C()(e);t&&(i=i.filter((function(t){return f()(e,t).enumerable}))),a.push.apply(a,i)}return a}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){Object(N["a"])(e,t,a[t])})):u.a?l()(e,u()(a)):z(Object(a)).forEach((function(t){o()(e,t,f()(a,t))}))}return e}var I={name:"detailPanel",components:{SitePopup:x["a"]},props:{tabActive:{type:Number,default:2}},data:function(){var e=this;this.$createElement;return{loading:!0,codes:"",selectCode:[],downDistrictCode:[],downCenterCode:[],isFirst:!0,defaultSite:[],selectData:{code:[],type:"",sumDate:q()().format("YYYY-MM")},cacheParams:{districtCode:[],centerCode:[],siteCode:[]},placeholder:"请输入管理区名称",dtype:"",manageAreaCode:"",month:"",applyType:[],applyStatus:[],tableData:[],total:0,pageSize:10,currentPage:1,expensesPolicyMaxDate:new Date,expensesPolicyMinDate:q()().subtract(24,"months").toDate(),commonTableHeader:[{field:"districtName",key:"districtName",title:"管理区",width:80,renderBodyCell:function(t,a){var i=t.row;t.column,t.rowIndex;return 2===e.tabActive?a("span",{class:"color2fe",on:{click:function(){return e.toNextTab(i,3)}}},[i.districtName]):a("span",[i.districtName])}},{field:"centerName",key:"centerName",title:"中心",fixed:"left",width:120,renderBodyCell:function(t,a){var i=t.row;t.column,t.rowIndex;if(3===e.tabActive)return a("span",{class:"color2fe",on:{click:function(){return e.toNextTab(i,1)}}},[i.centerName])}},{field:"backMoney",key:"backMoney",title:"网点欠费金额",width:120},{field:"backSiteNumber",key:"backSiteNumber",title:"欠费网点数",width:120,renderBodyCell:function(t,a){var i=t.row;t.column,t.rowIndex;return i.backSiteNumber?a("span",{class:"color2fe",on:{click:function(){return e.toSitePop(i,0)}}},[i.backSiteNumber]):a("span",[i.backSiteNumber])}},{field:"backSiteSequeNumber",key:"backSiteSequeNumber",title:"连续欠费网点数",width:140,renderBodyCell:function(t,a){var i=t.row;t.column,t.rowIndex;return i.backSiteSequeNumber?a("span",{class:"color2fe",on:{click:function(){return e.toSitePop(i,1)}}},[i.backSiteSequeNumber]):a("span",[i.backSiteSequeNumber])}},{field:"backSiteNosend",key:"backSiteNosend",title:"连续欠费且无发件网点数",width:180,renderBodyCell:function(t,a){var i=t.row;t.column,t.rowIndex;return i.backSiteNosend?a("span",{class:"color2fe",on:{click:function(){return e.toSitePop(i,2)}}},[i.backSiteNosend]):a("span",[i.backSiteNosend])}},{field:"backSiteSequeTypeStr",key:"backSiteSequeTypeStr",title:"是否连续欠费",width:120},{field:"backSiteNosendTypeStr",key:"backSiteNosendTypeStr",title:"是否连续欠费且无发件",width:170},{field:"backDay",key:"backDay",title:"本月欠费累计天数",width:160}]}},computed:B(B({},Object(A["d"])("user",["userInfo"])),{},{disableTabs:function(){return 2===this.tabActive?[1,3]:3===this.tabActive?[3]:[]},tableHeader:function(){var e=w()(this.commonTableHeader);return 2===this.tabActive?(e=e.filter((function(e){return"centerName"!==e.field&&"backSiteSequeTypeStr"!==e.field&&"backSiteNosendTypeStr"!==e.field&&"backDay"!==e.field})),e[0].fixed="left"):3===this.tabActive?e=e.filter((function(e){return"districtName"!==e.field&&"backSiteSequeTypeStr"!==e.field&&"backSiteNosendTypeStr"!==e.field&&"backDay"!==e.field})):1===this.tabActive&&(e=e.filter((function(e){return"centerName"!==e.field&&"backSiteNumber"!==e.field&&"backSiteNosend"!==e.field&&"backSiteSequeNumber"!==e.field})),e.unshift({field:"siteName",key:"siteName",title:"网点",width:120,fixed:"left"})),e}}),watch:{tabActive:{immediate:!0,handler:function(e){this.selectData.type=e,3===e?this.placeholder="请输入中心名称":1===e?this.placeholder="请输入网点名称":2===e&&(this.placeholder="请输入管区名称")}}},created:function(){this.parseRouterParams()},mounted:function(){},methods:{onAreaClean:function(){0===this.userInfo.authType&&"0"===this.userInfo.authCode?(this.codes="",this.selectData.code=[]):(this.codes=this.$route.query.name,this.selectData.code=this.$route.query.code.split()),this.selectCode=[],this.cacheParams={districtCode:[],centerCode:[],siteCode:[]},this.currentPage=1;var e=this.getParams();e.page=1,e.pageSize=this.pageSize,this.tableData=[],this.queryBackChargeDetail(e)},toSitePop:function(e,t){var a="";switch(t){case 0:a="欠费网点top10";break;case 1:a="连续欠费网点top10";break;case 2:a="连续欠费且无发件网点top10"}var i={title:a,topType:t,type:this.tabActive,siteCode:2===this.tabActive?e.districtCode:e.centerId,sumDate:this.selectData.sumDate};this.$refs.sitePopup.onOpen(i,0)},toNextTab:function(e,t){e.sumDate=this.selectData.sumDate,this.$emit("onDownTab",t,e)},getParams:function(e){var t=Number(this.$route.query.selectTab),a=this.$route.query.code,i=w()(this.selectData),s=e||this.tabActive;if(1===t){var c=this.cacheParams.centerCode.length?this.cacheParams.centerCode:this.selectData.code;i.districtCode=this.cacheParams.districtCode,i.centerCode=this.selectCode.length||this.cacheParams.districtCode.length?[]:c,i.siteCode=this.selectCode}else if(0===t&&"0"!==a){var r=this.cacheParams.districtCode.length?this.cacheParams.districtCode:this.selectData.code;i.districtCode=this.selectCode.length||this.cacheParams.centerCode.length?[]:r,i.centerCode=3===s&&this.selectCode.length?this.selectCode:this.cacheParams.centerCode,this.downCenterCode.length&&1===s&&(i.districtCode=[],i.centerCode=this.downCenterCode),i.siteCode=1===s&&this.selectCode.length?this.selectCode:[]}else{var n=this.cacheParams.districtCode.length?this.cacheParams.districtCode:this.selectData.code;i.districtCode=2===s&&this.selectCode.length?this.selectCode:n,this.selectCode.length||(i.districtCode=n),2!==s&&this.selectCode.length&&(i.districtCode=[]),i.centerCode=3===s&&this.selectCode.length?this.selectCode:this.cacheParams.centerCode,this.downCenterCode.length&&1===s&&(i.districtCode=[],i.centerCode=this.downCenterCode),this.downDistrictCode.length&&3===s&&(i.districtCode=this.downDistrictCode),i.siteCode=1===s&&this.selectCode.length?this.selectCode:[]}return delete i.code,i},parseRouterParams:function(){this.$route.query.month&&(this.selectData.sumDate=this.$route.query.month),this.selectData.type=this.tabActive,this.selectData.code="0"===this.$route.query.code?[]:this.$route.query.code.split(),this.defaultSite=[{code:this.$route.query.code,label:this.$route.query.name,type:Number(this.$route.query.selectTab)}],"0"!==this.$route.query.code&&(this.codes=this.$route.query.name);var e=this.getParams();e.page=1,e.pageSize=this.pageSize,this.tableData=[],this.queryBackChargeDetail(e)},onChangeTime:function(){this.currentPage=1;var e=this.getParams();e.page=1,e.pageSize=this.pageSize,this.tableData=[],this.queryBackChargeDetail(e)},onParChangeTab:function(e){this.currentPage=1,this.selectData.type=e;var t=this.getParams(e);t.page=1,t.pageSize=this.pageSize,this.tableData=[],this.queryBackChargeDetail(t)},onRefresh:function(e,t){this.currentPage=1,this.selectData.type=e;var a=w()(this.selectData);if(t&&(this.selectData.sumDate=t.sumDate),this.selectCode=[],1===this.selectData.type){this.codes=t.centerName,t&&(this.downCenterCode=String(t.centerId).split());var i=[],s=[];0!==Number(this.$route.query.selectTab)||t?1!==Number(this.$route.query.selectTab)||t||(s=this.selectData.code):i=this.selectData.code,a.districtCode=i,a.centerCode=t?String(t.centerId).split():s,a.siteCode=[]}else this.codes=t.districtName,t&&(this.downDistrictCode=String(t.districtCode).split()),a.districtCode=t?t.districtCode.split():this.selectData.code,a.centerCode=[],a.siteCode=[];a.sumDate=t?t.sumDate:a.sumDate,delete a.code,a.page=1,a.pageSize=this.pageSize,this.tableData=[],this.queryBackChargeDetail(a)},onFocus:function(){this.$refs.selectSite.onClickSiteSelect()},onChangeSite:function(e,t){this.currentPage=1;var a={districtCode:[],centerCode:[],siteCode:[]};if(1===this.tabActive?this.downCenterCode=[]:3===this.tabActive&&(this.downDistrictCode=[]),e.length)this.codes=e.map((function(e){return e.label})).join(","),this.selectCode=e.map((function(e){return e.value})),1===this.tabActive?a.siteCode=this.selectCode:2===this.tabActive?a.districtCode=this.selectCode:3===this.tabActive&&(a.centerCode=this.selectCode);else{this.selectCode=[],"0"!==t[t.length-1].code?this.codes=t[t.length-1].label:this.codes="";var i=t[t.length-1].type;0===i?a.districtCode="0"===t[t.length-1].code?[]:t[t.length-1].code.split():1===i?a.centerCode=t[t.length-1].code.split():3===i&&(a.siteCode=t[t.length-1].code.split())}this.cacheParams={districtCode:a.districtCode,centerCode:a.centerCode,siteCode:a.siteCode},a.type=this.tabActive,a.sumDate=this.selectData.sumDate,a.page=1,a.pageSize=this.pageSize,this.tableData=[],this.queryBackChargeDetail(a)},queryBackChargeDetail:function(e){var t,a;return S.a.async((function(i){while(1)switch(i.prev=i.next){case 0:return i.next=2,S.a.awrap(Object($["t"])(e));case 2:a=i.sent,(t=this.tableData).push.apply(t,Object(k["a"])(a.list)),this.total=a.totalRow;case 5:case"end":return i.stop()}}),null,this,null,D.a)},updateData:function(e){if(this.currentPage++,this.tableData.length<this.total){var t=this.getParams();this.queryBackChargeDetail(B({pageSize:this.pageSize,page:this.currentPage},t))}},displayMore:function(e){this.currentPage=1,this.tableData=[];var t=this.getParams();this.queryBackChargeDetail(B({pageSize:this.pageSize,page:this.currentPage},t))}}},M=I,j=(a("ef8d"),a("2877")),O=Object(j["a"])(M,c,r,!1,null,"025863c2",null),_=O.exports,E={name:"siteArrearage",components:{DetailPanel:_},data:function(){return{active:2,codes:"",tabList:[{tabName:"管区",type:2},{tabName:"中心",type:3},{tabName:"网点",type:1}]}},computed:{tabs:function(){var e=this.$route.query.selectTab,t=this.$route.query.code,a=this.tabList;return 0===Number(e)&&"0"!==t?a=this.tabList.filter((function(e){return 2!==e.type})):1===Number(e)&&(a=this.tabList.filter((function(e){return 2!==e.type&&3!==e.type}))),a}},created:function(){this.active=this.getQueryType()},mounted:function(){},methods:{getQueryType:function(){var e=this.$route.query.code,t=Number(this.$route.query.selectTab),a=2;return 0===t&&"0"!==e?a=3:1===t&&(a=1),a},onDownTab:function(e,t){this.active=e;var a=this.$refs["detailPanel"+e];a&&a[0].onRefresh(e,t)},onBeforeChangeTab:function(e){return!0},onChangeTab:function(e){var t=this.$refs["detailPanel"+e];t&&t[0].onParChangeTab(e)}}},F=E,H=(a("84ff"),Object(j["a"])(F,i,s,!1,null,"acbb446c",null));t["default"]=H.exports},ef8d:function(e,t,a){"use strict";var i=a("a716"),s=a.n(i);s.a}}]);