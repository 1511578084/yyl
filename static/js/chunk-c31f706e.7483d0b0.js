(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c31f706e"],{3241:function(e,t,i){"use strict";var a=i("e0e3"),s=i.n(a);s.a},"69c8":function(e,t,i){},"9ff6":function(e,t,i){"use strict";var a=i("69c8"),s=i.n(a);s.a},d579:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"siteExpense",staticClass:"siteExpense"},[i("van-tabs",{ref:"tabs",attrs:{color:"#3693ff","title-active-color":"#3693ff",background:"#fff","before-change":e.onBeforeChangeTab,"lazy-render":!1,sticky:""},on:{change:e.onChangeTab},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},e._l(e.tabs,(function(t){return i("van-tab",{key:t.type,attrs:{title:t.tabName,name:t.type}},[i("detail-panel",{ref:"detailPanel"+t.type,refInFor:!0,attrs:{tabActive:e.active},on:{onDownTab:e.onDownTab}})],1)})),1)],1)},s=[],n=(i("4de4"),i("a9e3"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"detailPenal"},[i("div",{staticClass:"form-field"},[i("div",{staticClass:"area-search"},[i("van-search",{attrs:{shape:"round",background:"#fff",placeholder:e.placeholder,readonly:""},on:{focus:e.onFocus},model:{value:e.codes,callback:function(t){e.codes=t},expression:"codes"}}),e.codes?i("van-icon",{staticClass:"close-icon",attrs:{name:"close"},on:{click:e.onAreaClean}}):e._e()],1),i("b-select-date",{staticClass:"area-date",attrs:{stype:"year-month",zoneNo:!0,title:"请选择年月",minDate:e.expensesPolicyMinDate,maxDate:e.expensesPolicyMaxDate},on:{change:e.onChangeTime},model:{value:e.selectData.sumDate,callback:function(t){e.$set(e.selectData,"sumDate",t)},expression:"selectData.sumDate"}})],1),i("b-select-site-multiple",{ref:"selectSite",attrs:{defaultData:e.defaultSite,disableTabs:e.disableTabs},on:{change:e.onChangeSite},model:{value:e.selectCode,callback:function(t){e.selectCode=t},expression:"selectCode"}}),i("div",{staticClass:"content"},[i("hy-table",{staticClass:"base-table",attrs:{"table-data":e.tableData,columns:e.tableHeader,scrollWidth:"100%",border:"",theme:"light","border-y":!0,isShowMore:!0,total:e.total,isFixedHeader:!0},on:{updateData:e.updateData,displayMore:e.displayMore}})],1),i("site-popup",{ref:"sitePopup"})],1)}),o=[],c=(i("4160"),i("a15b"),i("d81d"),i("b0c0"),i("d3b7"),i("ac1f"),i("1276"),i("c7cd"),i("159b"),i("85f2")),r=i.n(c),l=i("d847"),d=i.n(l),h=i("5e83"),u=i.n(h),f=i("268f"),p=i.n(f),m=i("e265"),b=i.n(m),C=i("a4bb"),g=i.n(C),y=i("795b"),D=i.n(y),v=i("967e"),N=i.n(v),k=i("284c"),P=(i("96cf"),i("2fa7")),S=i("0644"),T=i.n(S),w=i("c1df"),$=i.n(w),x=i("2f62"),q=i("538d"),z=i("0532");function A(e,t){var i=g()(e);if(b.a){var a=b()(e);t&&(a=a.filter((function(t){return p()(e,t).enumerable}))),i.push.apply(i,a)}return i}function F(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?A(Object(i),!0).forEach((function(t){Object(P["a"])(e,t,i[t])})):u.a?d()(e,u()(i)):A(Object(i)).forEach((function(t){r()(e,t,p()(i,t))}))}return e}var L={name:"detailPanel",components:{SitePopup:z["a"]},props:{tabActive:{type:Number,default:2}},data:function(){var e=this;this.$createElement;return{loading:!0,codes:"",selectCode:[],downDistrictCode:[],downCenterCode:[],isFirst:!0,defaultSite:[],selectData:{code:[],type:"",sumDate:$()().format("YYYY-MM")},cacheParams:{districtCode:[],centerCode:[],siteCode:[]},placeholder:"请输入管理区名称",dtype:"",manageAreaCode:"",month:"",applyType:[],applyStatus:[],tableData:[],total:0,pageSize:10,currentPage:1,expensesPolicyMaxDate:new Date,expensesPolicyMinDate:$()().subtract(24,"months").toDate(),commonTableHeader:[{field:"districtName",key:"districtName",title:"管理区",width:80,renderBodyCell:function(t,i){var a=t.row;t.column,t.rowIndex;return 2===e.tabActive?i("span",{class:"color2fe",on:{click:function(){return e.toNextTab(a,1)}}},[a.districtName]):i("span",[a.districtName])}},{field:"centerName",key:"centerName",title:"中心",width:120},{title:"面单情况",children:[{field:"billNoCompensateSiteNum",key:"billNoCompensateSiteNum",title:"面单连续2个月无补贴网点数",width:200,renderBodyCell:function(t,i){var a=t.row;t.column,t.rowIndex;return Number(a.billNoCompensateSiteNum)?i("span",{class:"color2fe",on:{click:function(){return e.toSitePop(a,6)}}},[a.billNoCompensateSiteNum]):i("span",[a.billNoCompensateSiteNum])}},{field:"billNoCompensateSiteTypeStr",key:"billNoCompensateSiteTypeStr",title:"是否面单连续2个月无补贴",width:200},{field:"billTicketProfit",key:"billTicketProfit",title:"面单单票收入",width:120},{field:"billTicketSubsidy",key:"billTicketSubsidy",title:"面单单票补贴",width:120}]},{title:"中转情况",children:[{field:"tranfeeLossLineNum",key:"tranfeeLossLineNum",title:"中转费亏损线路个数",width:150,renderBodyCell:function(t,i){var a=t.row;t.column,t.rowIndex;return Number(a.tranfeeLossLineNum)?i("span",{class:"color2fe",on:{click:function(){return e.toSitePop(a,9)}}},[a.tranfeeLossLineNum]):i("span",[a.tranfeeLossLineNum])}},{field:"tranfeeTicketProfit",key:"tranfeeTicketProfit",title:"中转单票利润",width:120},{field:"tranfeeTicketIncome",key:"tranfeeTicketIncome",title:"中转单票收入",width:120},{field:"tranfeeTicketCost",key:"tranfeeTicketCost",title:"中转单票成本",width:120}]},{title:"派费情况",children:[{field:"ticketSendDispatchFee",key:"ticketSendDispatchFee",title:"单票寄件派费",width:120},{field:"ticketTakeFee",key:"ticketTakeFee",title:"单票到手派费",width:120},{field:"ticketTakeSubsidy",key:"ticketTakeSubsidy",title:"单票派费到手补贴",width:140},{field:"ticketDispatchTrim",key:"ticketDispatchTrim",title:"单票派费截留",width:120}]}]}},computed:F(F({},Object(x["d"])("user",["userInfo"])),{},{disableTabs:function(){return 2===this.tabActive?[1,3]:3===this.tabActive?[3]:[]},tableHeader:function(){var e=T()(this.commonTableHeader);return 2===this.tabActive?(e=T()(this.commonTableHeader).filter((function(e){return"centerName"!==e.field&&"siteName"!==e.field})),e.forEach((function(e){"面单情况"===e.title&&(e.children=e.children.filter((function(e){return"billNoCompensateSiteTypeStr"!==e.field})))})),e[0].fixed="left"):1===this.tabActive&&(e=T()(this.commonTableHeader).filter((function(e){return"中转情况"!==e.title})),e.forEach((function(e){"面单情况"===e.title&&(e.children=e.children.filter((function(e){return"billNoCompensateSiteNum"!==e.field})))})),e.unshift({field:"siteName",key:"siteName",title:"网点",width:120,fixed:"left"})),e}}),watch:{tabActive:{immediate:!0,handler:function(e){3===e?this.placeholder="请输入中心名称":1===e?this.placeholder="请输入网点名称":2===e&&(this.placeholder="请输入管区名称")}}},created:function(){this.parseRouterParams()},mounted:function(){},methods:{onAreaClean:function(){0===this.userInfo.authType&&"0"===this.userInfo.authCode?(this.codes="",this.selectData.code=[]):(this.codes=this.$route.query.name,this.selectData.code=this.$route.query.code.split()),this.selectCode=[],this.cacheParams={districtCode:[],centerCode:[],siteCode:[]},this.currentPage=1;var e=this.getParams();e.page=1,e.pageSize=this.pageSize,this.tableData=[],this.getNationFeeDetail(e)},toSitePop:function(e,t){var i="";switch(t){case 6:i="连续2个月无面单补贴网点";break;case 9:i="中转亏损线路";break}var a={title:i,topType:t,type:this.tabActive,siteCode:2===this.tabActive?e.districtCode:e.centerId,sumDate:this.selectData.sumDate};this.$refs.sitePopup.onOpen(a,2)},toNextTab:function(e,t){e.sumDate=this.selectData.sumDate,this.$emit("onDownTab",t,e)},getParams:function(e){var t=Number(this.$route.query.selectTab),i=this.$route.query.code,a=T()(this.selectData),s=e||this.tabActive;if(1===t){var n=this.cacheParams.centerCode.length?this.cacheParams.centerCode:this.selectData.code;a.districtCode=this.cacheParams.districtCode,a.centerCode=this.selectCode.length||this.cacheParams.districtCode.length?[]:n,a.siteCode=this.selectCode}else if(0===t&&"0"!==i){var o=this.cacheParams.districtCode.length?this.cacheParams.districtCode:this.selectData.code;a.districtCode=this.selectCode.length||this.cacheParams.centerCode.length?[]:o,a.centerCode=3===s&&this.selectCode.length?this.selectCode:this.cacheParams.centerCode,this.downCenterCode.length&&1===s&&(a.districtCode=[],a.centerCode=this.downCenterCode),a.siteCode=1===s&&this.selectCode.length?this.selectCode:[]}else{var c=this.cacheParams.districtCode.length?this.cacheParams.districtCode:this.selectData.code;a.districtCode=2===s&&this.selectCode.length?this.selectCode:c,this.selectCode.length||(a.districtCode=c),2!==s&&this.selectCode.length&&(a.districtCode=[]),a.centerCode=3===s&&this.selectCode.length?this.selectCode:this.cacheParams.centerCode,this.downCenterCode.length&&1===s&&(a.districtCode=[],a.centerCode=this.downCenterCode),this.downDistrictCode.length&&1===s&&(a.districtCode=this.downDistrictCode),a.siteCode=1===s&&this.selectCode.length?this.selectCode:[]}return delete a.code,a},parseRouterParams:function(){this.$route.query.month&&(this.selectData.sumDate=this.$route.query.month),this.selectData.type=this.tabActive,this.selectData.code="0"===this.$route.query.code?[]:this.$route.query.code.split(),this.defaultSite=[{code:this.$route.query.code,label:this.$route.query.name,type:Number(this.$route.query.selectTab)}],"0"!==this.$route.query.code&&(this.codes=this.$route.query.name);var e=this.getParams();e.page=1,e.pageSize=this.pageSize,this.tableData=[],this.getNationFeeDetail(e)},onFocus:function(){this.$refs.selectSite.onClickSiteSelect()},onParChangeTab:function(e){this.currentPage=1,this.selectData.type=e;var t=this.getParams(e);t.page=1,t.pageSize=this.pageSize,this.tableData=[],this.getNationFeeDetail(t)},onRefresh:function(e,t){this.currentPage=1,this.selectData.type=e;var i=T()(this.selectData);t&&(this.downDistrictCode=String(t.districtCode).split()),t&&(this.selectData.sumDate=t.sumDate),this.codes=t.districtName,this.selectCode=[];var a=[],s=[];0!==Number(this.$route.query.selectTab)||t?1!==Number(this.$route.query.selectTab)||t||(s=this.selectData.code):a=this.selectData.code,i.districtCode=t?String(t.districtCode).split():a,i.centerCode=s,i.siteCode=[],i.sumDate=t?t.sumDate:i.sumDate,delete i.code,i.page=1,i.pageSize=this.pageSize,this.tableData=[],this.getNationFeeDetail(i)},onChangeSite:function(e,t){this.currentPage=1,this.codes=e.map((function(e){return e.label})).join(","),this.selectCode=e.map((function(e){return e.value}));var i={};if(this.downCenterCode=[],this.downDistrictCode=[],i.districtCode=[],i.centerCode=[],i.siteCode=[],e.length)this.codes=e.map((function(e){return e.label})).join(","),this.selectCode=e.map((function(e){return e.value})),1===this.tabActive?i.siteCode=this.selectCode:2===this.tabActive?i.districtCode=this.selectCode:3===this.tabActive&&(i.centerCode=this.selectCode);else{this.selectCode=[],"0"!==t[t.length-1].code?this.codes=t[t.length-1].label:this.codes="";var a=t[t.length-1].type;0===a?i.districtCode="0"===t[t.length-1].code?[]:t[t.length-1].code.split():1===a?i.centerCode=t[t.length-1].code.split():3===a&&(i.siteCode=t[t.length-1].code.split())}this.cacheParams={districtCode:i.districtCode,centerCode:i.centerCode,siteCode:i.siteCode},i.type=this.tabActive,i.sumDate=this.selectData.sumDate,i.page=1,i.pageSize=this.pageSize,this.tableData=[],this.getNationFeeDetail(i)},onChangeTime:function(){this.currentPage=1;var e=this.getParams();e.page=1,e.pageSize=this.pageSize,this.tableData=[],this.getNationFeeDetail(e)},getNationFeeDetail:function(e){var t,i;return N.a.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,N.a.awrap(Object(q["r"])(e));case 2:i=a.sent,(t=this.tableData).push.apply(t,Object(k["a"])(i.list)),this.total=i.totalRow;case 5:case"end":return a.stop()}}),null,this,null,D.a)},updateData:function(e){if(this.currentPage++,this.tableData.length<this.total){var t=this.getParams();this.getNationFeeDetail(F({pageSize:this.pageSize,page:this.currentPage},t))}},displayMore:function(e){this.currentPage=1,this.tableData=[];var t=this.getParams();this.getNationFeeDetail(F({pageSize:this.pageSize,page:this.currentPage},t))}}},j=L,E=(i("3241"),i("2877")),I=Object(E["a"])(j,n,o,!1,null,"03ec1a6c",null),M=I.exports,O={name:"siteExpense",components:{DetailPanel:M},data:function(){return{active:2,codes:"",tabList:[{tabName:"管区",type:2},{tabName:"网点",type:1}]}},computed:{tabs:function(){var e=this.$route.query.selectTab,t=this.$route.query.code,i=this.tabList;return 0===Number(e)&&"0"!==t?i=this.tabList.filter((function(e){return 2!==e.type})):1===Number(e)&&(i=this.tabList.filter((function(e){return 2!==e.type&&3!==e.type}))),i}},created:function(){this.active=this.getQueryType()},mounted:function(){},methods:{getQueryType:function(){var e=this.$route.query.code,t=Number(this.$route.query.selectTab),i=2;return(0===t&&"0"!==e||1===t)&&(i=1),i},onDownTab:function(e,t){this.active=e;var i=this.$refs["detailPanel"+e];i&&i[0].onRefresh(e,t)},onBeforeChangeTab:function(e){return!0},onChangeTab:function(e){var t=this.$refs["detailPanel"+e];t&&t[0].onParChangeTab(e)}}},H=O,_=(i("9ff6"),Object(E["a"])(H,a,s,!1,null,"9c4c92f2",null));t["default"]=_.exports},e0e3:function(e,t,i){}}]);